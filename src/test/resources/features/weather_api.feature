# language: ru
Функция: Тестирование Weather API

  Как QA инженер
  Я хочу протестировать Weather API
  Чтобы убедиться в корректности работы сервиса получения данных о погоде

  Предыстория:
    Дано сервис WeatherAPI запущен на порту 8080
    И у меня есть валидный API ключ "test_api_key_123"

  @positive @current_weather
  Сценарий: Получение текущей погоды для различных городов
    Когда я запрашиваю текущую погоду для города "London"
    Тогда статус ответа должен быть 200
    И ответ содержит информацию о местоположении
    И название города в ответе равно "London"
    И страна в ответе равна "United Kingdom"
    И ответ содержит данные о текущей погоде
    И температура в Цельсиях присутствует в ответе
    И влажность присутствует в ответе
    И информация о ветре присутствует в ответе
    И я логирую результат сравнения

    Когда я запрашиваю текущую погоду для города "Paris"
    Тогда статус ответа должен быть 200
    И ответ содержит информацию о местоположении
    И название города в ответе равно "Paris"
    И страна в ответе равна "France"
    И ответ содержит данные о текущей погоде
    И температура в Цельсиях присутствует в ответе
    И влажность присутствует в ответе
    И информация о ветре присутствует в ответе
    И я логирую результат сравнения

    Когда я запрашиваю текущую погоду для города "Tokyo"
    Тогда статус ответа должен быть 200
    И ответ содержит информацию о местоположении
    И название города в ответе равно "Tokyo"
    И страна в ответе равна "Japan"
    И ответ содержит данные о текущей погоде
    И температура в Цельсиях присутствует в ответе
    И влажность присутствует в ответе
    И информация о ветре присутствует в ответе
    И я логирую результат сравнения

    Когда я запрашиваю текущую погоду для города "New York"
    Тогда статус ответа должен быть 200
    И ответ содержит информацию о местоположении
    И название города в ответе равно "New York"
    И страна в ответе равна "United States of America"
    И ответ содержит данные о текущей погоде
    И температура в Цельсиях присутствует в ответе
    И влажность присутствует в ответе
    И информация о ветре присутствует в ответе
    И я логирую результат сравнения

  @negative @api_errors
  Сценарий: Получение различных ошибок API
    Когда я запрашиваю текущую погоду без API ключа для города "London"
    Тогда статус ответа должен быть 401
    И ответ содержит ошибку с кодом 1002
    И сообщение об ошибке равно "API key not provided."
    И я логирую результат сравнения ошибки

    Когда я запрашиваю текущую погоду без параметра города
    Тогда статус ответа должен быть 400
    И ответ содержит ошибку с кодом 1003
    И сообщение об ошибке равно "Parameter 'q' not provided."
    И я логирую результат сравнения ошибки

    Когда я запрашиваю текущую погоду с невалидным API ключом "invalid_key_12345" для города "London"
    Тогда статус ответа должен быть 401
    И ответ содержит ошибку с кодом 2006
    И сообщение об ошибке равно "API key provided is invalid"
    И я логирую результат сравнения ошибки

    Когда я запрашиваю текущую погоду для несуществующего города "NonExistentCity123"
    Тогда статус ответа должен быть 400
    И ответ содержит ошибку с кодом 1006
    И сообщение об ошибке равно "No location found matching parameter 'q'"
    И я логирую результат сравнения ошибки 